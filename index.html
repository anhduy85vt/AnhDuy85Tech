if (location.protocol === "file:") {
    alert(
        "‚ö†Ô∏è Camera & Micro s·∫Ω KH√îNG ho·∫°t ƒë·ªông khi m·ªü file tr·ª±c ti·∫øp.\n\n" +
        "‚úîÔ∏è H√£y d√πng GitHub Pages (https://)\n" +
        "‚úîÔ∏è Ho·∫∑c ch·∫°y b·∫±ng Live Server / localhost"
    );
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hardware Master Test - ANH DUY</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body
        <div id="securityNotice" style="
    position:fixed;
    bottom:20px;
    right:20px;
    max-width:320px;
    background:#020617;
    border:1px solid #1e293b;
    padding:14px 16px;
    border-radius:14px;
    font-size:12px;
    z-index:9999;
    box-shadow:0 10px 30px rgba(0,0,0,.5)
">
    <b class="text-blue-400">üîí Quy·ªÅn truy c·∫≠p thi·∫øt b·ªã</b>
    <p class="mt-1 text-gray-300">
        Website n√†y <b>KH√îNG l∆∞u d·ªØ li·ªáu</b>.<br>
        Camera & Micro ch·ªâ d√πng ƒë·ªÉ test tr·ª±c ti·∫øp tr√™n tr√¨nh duy·ªát.
    </p>
    <button onclick="this.parentElement.remove()"
        class="mt-2 text-xs text-blue-400 underline">
        T√¥i ƒë√£ hi·ªÉu
    </button>
</div>

        { background: #0f172a; color: white; font-family: 'Segoe UI', sans-serif; height: 100vh; overflow: hidden; margin:0; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .nav-item { transition: 0.3s; cursor: pointer; padding: 0.8rem 1.2rem; display: flex; align-items: center; border-radius: 12px; margin-bottom: 0.5rem; font-size: 14px; font-weight: 600; }
        .nav-item:hover { background: rgba(59, 130, 246, 0.2); }
        .nav-item.active { background: #3b82f6 !important; color: white; }
        
        .test-section { display: none; height: 100%; animation: fadeIn 0.2s ease; }
        .test-section.active { display: block; }

        /* KEYBOARD FIX - KH√îNG D√ôNG MARGIN √ÇM */
        .kb-container { background: #111827; padding: 15px; border-radius: 1rem; border: 3px solid #334155; display: inline-flex; gap: 15px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
        .key-column { display: flex; flex-direction: column; gap: 4px; }
        .row { display: flex; gap: 4px; }
        
        .key { 
            background: #1e293b; color: #94a3b8; font-size: 9px; font-weight: bold; 
            width: 38px; height: 38px; display: flex; align-items: center; justify-content: center; 
            border-radius: 5px; border: 1px solid #334155; transition: 0.05s; text-transform: uppercase;
            box-sizing: border-box;
        }
        .key-pressed { background: #3b82f6 !important; color: white !important; transform: scale(0.9); box-shadow: 0 0 10px #3b82f6; }
        .key-passed { background: #10b981 !important; color: white !important; border-color: #34d399 !important; }
        
        /* Widths */
        .w-tab { width: 55px; } .w-caps { width: 68px; } .w-shift-l { width: 90px; }
        .w-backspace { width: 84px; } .w-enter { width: 89px; } .w-shift-r { width: 104px; }
        .w-space { width: 282px; } .w-numpad-0 { width: 80px; }
        .h-double { height: 80px; } /* Ph√≠m c·ªông v√† enter numpad */

        .spacer-f { width: 40px; } 
        .contact-info { margin-top: auto; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1); }
    </style>
</head>
<body class="flex p-4 gap-4">

    <div class="w-64 glass rounded-3xl p-6 flex flex-col">
        <h1 class="text-xl font-bold italic text-blue-400 mb-8 text-center uppercase tracking-tighter">ANH DUY MASTER</h1>
        <nav class="flex-grow">
            <div onclick="showTab('keyboard')" id="m-keyboard" class="nav-item active"><i class="fas fa-keyboard w-8"></i> B√ÄN PH√çM</div>
            <div onclick="showTab('camera')" id="m-camera" class="nav-item"><i class="fas fa-camera w-8"></i> CAMERA</div>
            <div onclick="showTab('mic')" id="m-mic" class="nav-item"><i class="fas fa-microphone w-8"></i> MICROPHONE</div>
        </nav>
        <div class="contact-info">
            <p class="text-[9px] text-gray-500 font-bold mb-1 uppercase">H·ªó tr·ª£ k·ªπ thu·∫≠t:</p>
            <p class="text-[11px] text-blue-300 font-mono">ANHDUY85VT@GMAIL.COM</p>
        </div>
    </div>

    <div class="flex-1 flex flex-col gap-4 overflow-hidden">
        <section id="keyboard" class="test-section active glass rounded-3xl p-6 flex flex-col items-center justify-center">
            <div class="w-full flex justify-between mb-6 px-4">
                <h2 class="text-xl font-bold text-blue-400 uppercase italic">Keyboard Precision Test</h2>
                <button onclick="resetKb()" class="bg-red-500/20 text-red-500 px-4 py-1 rounded border border-red-500 text-xs font-bold">RESET</button>
            </div>

            <div class="kb-container scale-90">
                <div class="key-column">
                    <div class="row">
                        <div class="key" id="key-Escape">Esc</div><div class="spacer-f"></div>
                        <div class="key" id="key-F1">F1</div><div class="key" id="key-F2">F2</div><div class="key" id="key-F3">F3</div><div class="key" id="key-F4">F4</div><div class="spacer-f" style="width:15px"></div>
                        <div class="key" id="key-F5">F5</div><div class="key" id="key-F6">F6</div><div class="key" id="key-F7">F7</div><div class="key" id="key-F8">F8</div><div class="spacer-f" style="width:15px"></div>
                        <div class="key" id="key-F9">F9</div><div class="key" id="key-F10">F10</div><div class="key" id="key-F11">F11</div><div class="key" id="key-F12">F12</div>
                    </div>
                    <div class="row">
                        <div class="key" id="key-Backquote">`</div><div class="key" id="key-Digit1">1</div><div class="key" id="key-Digit2">2</div><div class="key" id="key-Digit3">3</div><div class="key" id="key-Digit4">4</div><div class="key" id="key-Digit5">5</div><div class="key" id="key-Digit6">6</div><div class="key" id="key-Digit7">7</div><div class="key" id="key-Digit8">8</div><div class="key" id="key-Digit9">9</div><div class="key" id="key-Digit0">0</div><div class="key" id="key-Minus">-</div><div class="key" id="key-Equal">=</div><div class="key w-backspace" id="key-Backspace">Bksp</div>
                    </div>
                    <div class="row">
                        <div class="key w-tab" id="key-Tab">Tab</div><div class="key" id="key-KeyQ">Q</div><div class="key" id="key-KeyW">W</div><div class="key" id="key-KeyE">E</div><div class="key" id="key-KeyR">R</div><div class="key" id="key-KeyT">T</div><div class="key" id="key-KeyY">Y</div><div class="key" id="key-KeyU">U</div><div class="key" id="key-KeyI">I</div><div class="key" id="key-KeyO">O</div><div class="key" id="key-KeyP">P</div><div class="key" id="key-BracketLeft">[</div><div class="key" id="key-BracketRight">]</div><div class="key" id="key-Backslash">\</div>
                    </div>
                    <div class="row">
                        <div class="key w-caps" id="key-CapsLock">Caps</div><div class="key" id="key-KeyA">A</div><div class="key" id="key-KeyS">S</div><div class="key" id="key-KeyD">D</div><div class="key" id="key-KeyF">F</div><div class="key" id="key-KeyG">G</div><div class="key" id="key-KeyH">H</div><div class="key" id="key-KeyJ">J</div><div class="key" id="key-KeyK">K</div><div class="key" id="key-KeyL">L</div><div class="key" id="key-Semicolon">;</div><div class="key" id="key-Quote">'</div><div class="key w-enter" id="key-Enter">Enter</div>
                    </div>
                    <div class="row">
                        <div class="key w-shift-l" id="key-ShiftLeft">Shift</div><div class="key" id="key-KeyZ">Z</div><div class="key" id="key-KeyX">X</div><div class="key" id="key-KeyC">C</div><div class="key" id="key-KeyV">V</div><div class="key" id="key-KeyB">B</div><div class="key" id="key-KeyN">N</div><div class="key" id="key-KeyM">M</div><div class="key" id="key-Comma">,</div><div class="key" id="key-Period">.</div><div class="key" id="key-Slash">/</div><div class="key w-shift-r" id="key-ShiftRight">Shift</div>
                    </div>
                    <div class="row">
                        <div class="key" id="key-ControlLeft">Ctrl</div><div class="key" id="key-MetaLeft">Win</div><div class="key" id="key-AltLeft">Alt</div><div class="key w-space" id="key-Space">Space</div><div class="key" id="key-AltRight">Alt</div><div class="key" id="key-MetaRight">Win</div><div class="key" id="key-ContextMenu">Fn</div><div class="key" id="key-ControlRight">Ctrl</div>
                    </div>
                </div>

                <div class="key-column">
                    <div class="row"><div class="key" id="key-PrintScreen">Prt</div><div class="key" id="key-ScrollLock">Scr</div><div class="key" id="key-Pause">Pau</div></div>
                    <div class="row"><div class="key" id="key-Insert">Ins</div><div class="key" id="key-Home">Hm</div><div class="key" id="key-PageUp">Pu</div></div>
                    <div class="row"><div class="key" id="key-Delete">Del</div><div class="key" id="key-End">End</div><div class="key" id="key-PageDown">Pd</div></div>
                    <div class="row" style="height:38px"></div>
                    <div class="row flex justify-center"><div class="key" id="key-ArrowUp">‚Üë</div></div>
                    <div class="row"><div class="key" id="key-ArrowLeft">‚Üê</div><div class="key" id="key-ArrowDown">‚Üì</div><div class="key" id="key-ArrowRight">‚Üí</div></div>
                </div>

                <div class="key-column">
                    <div class="row" style="height:38px"></div>
                    <div class="row"><div class="key" id="key-NumLock">Num</div><div class="key" id="key-NumpadDivide">/</div><div class="key" id="key-NumpadMultiply">*</div><div class="key" id="key-NumpadSubtract">-</div></div>
                    <div class="row">
                        <div class="key-column" style="gap:4px">
                            <div class="row"><div class="key" id="key-Numpad7">7</div><div class="key" id="key-Numpad8">8</div><div class="key" id="key-Numpad9">9</div></div>
                            <div class="row"><div class="key" id="key-Numpad4">4</div><div class="key" id="key-Numpad5">5</div><div class="key" id="key-Numpad6">6</div></div>
                        </div>
                        <div class="key h-double" id="key-NumpadAdd">+</div>
                    </div>
                    <div class="row">
                        <div class="key-column" style="gap:4px">
                            <div class="row"><div class="key" id="key-Numpad1">1</div><div class="key" id="key-Numpad2">2</div><div class="key" id="key-Numpad3">3</div></div>
                            <div class="row"><div class="key w-numpad-0" id="key-Numpad0">0</div><div class="key" id="key-NumpadDecimal">.</div></div>
                        </div>
                        <div class="key h-double" id="key-NumpadEnter">Ent</div>
                    </div>
                </div>
            </div>
        </section>

        <section id="camera" class="test-section glass rounded-3xl p-8"><video id="v" autoplay class="w-full max-w-xl mx-auto rounded-2xl bg-black border-4 border-gray-800"></video><center><button onclick="startCam()" class="mt-8 bg-blue-600 px-10 py-3 rounded-xl font-bold">M·ªû CAMERA</button></center></section>
        <section id="mic" class="test-section glass rounded-3xl p-8"><div class="max-w-md mx-auto bg-gray-900 p-8 rounded-2xl border border-gray-700"><div class="h-6 bg-gray-800 rounded-full overflow-hidden mb-4"><div id="m-bar" class="h-full bg-green-500 w-0 transition-all"></div></div><div id="m-status" class="text-center text-4xl font-mono text-green-400">0%</div></div><center><button onclick="startMic()" class="mt-8 bg-green-600 px-10 py-3 rounded-xl font-bold">TH·ª¨ MIC</button></center></section>
    </div>

    <script>
        function showTab(id) {
            document.querySelectorAll('.test-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.getElementById('m-' + id).classList.add('active');
        }
        window.onkeydown = (e) => {
            if(document.getElementById('keyboard').classList.contains('active')) {
                e.preventDefault();
                const k = document.getElementById('key-' + e.code);
                if(k) k.classList.add('key-pressed');
            }
        };
        window.onkeyup = (e) => {
            const k = document.getElementById('key-' + e.code);
            if(k) { k.classList.remove('key-pressed'); k.classList.add('key-passed'); }
        };
        function resetKb() { document.querySelectorAll('.key').forEach(k => k.classList.remove('key-passed')); }
        async function startCam() {
    try {
        if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
            alert("‚ùå Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ camera");
            return;
        }

        const stream = await navigator.mediaDevices.getUserMedia({
            video: { width: 1280, height: 720 }
        });

        const video = document.getElementById("v");
        video.srcObject = stream;

    } catch (err) {
        alert(
            "‚ùå Kh√¥ng truy c·∫≠p ƒë∆∞·ª£c camera\n\n" +
            "‚Ä¢ B·∫°n ch∆∞a c·∫•p quy·ªÅn\n" +
            "‚Ä¢ Camera ƒëang ƒë∆∞·ª£c app kh√°c s·ª≠ d·ª•ng\n" +
            "‚Ä¢ Tr√¨nh duy·ªát b·ªã ch·∫∑n quy·ªÅn"
        );
    }
}

       async function startMic() {
    try {
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });

        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const analyser = ctx.createAnalyser();
        analyser.fftSize = 256;

        const source = ctx.createMediaStreamSource(stream);
        source.connect(analyser);

        const data = new Uint8Array(analyser.frequencyBinCount);

        function loop() {
            analyser.getByteFrequencyData(data);

            let avg = data.reduce((a, b) => a + b) / data.length;
            let level = Math.min(Math.round(avg * 2), 100);

            document.getElementById("m-bar").style.width = level + "%";
            document.getElementById("m-status").innerText = level + "%";

            requestAnimationFrame(loop);
        }

        loop();

    } catch {
        alert(
            "‚ùå Kh√¥ng truy c·∫≠p ƒë∆∞·ª£c Microphone\n\n" +
            "‚Ä¢ B·∫°n ch∆∞a c·∫•p quy·ªÅn\n" +
            "‚Ä¢ Micro ƒëang b·ªã app kh√°c chi·∫øm\n" +
            "‚Ä¢ Tr√¨nh duy·ªát b·ªã ch·∫∑n quy·ªÅn"
        );
    }
}

    </script>
</body>

</html>
